<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Producción Fiscalizada de Gas Natural</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
</head>
<body>
    <div id="container" style="width:100%; height:600px;"></div>
    <script>
        const csv = `
,Nombre_Recurso,Fecha_Operacion,Combustible_por_Defecto,capacidad_acumulada,numero_proyectos
137,LAS VIOLETAS,2022-03-30,AGUA,0.945,1
141,CAUYA,2022-04-25,AGUA,2.455,2
131,ZEUS,2022-05-19,AGUA,12.355,3
134,AUTOG GRAN COLOMBIA GOLD,2022-05-31,AGUA,13.355,4
139,LA CHORRERA,2022-05-31,AGUA,28.355,5
97,SAN BARTOLOME,2023-05-14,AGUA,48.254999999999995,6
122,OIBITA,2023-05-14,AGUA,68.155,7
91,LA CASCADA DE GRANADA,2023-09-30,AGUA,70.245,8
0,AUTOG BIODIANA 1,2025-01-25,BIOMASA,4.99,1
147,HELIOS I,2022-03-03,RAD SOLAR,16.0,1
130,GR PARQUE SOLAR TUCANES,2022-05-31,RAD SOLAR,25.9,2
133,AUTOG CELSIA SOLAR LEVAPAN,2022-06-11,RAD SOLAR,30.89,3
138,GY SOLAR AURORA,2022-08-11,RAD SOLAR,40.79,4
127,SINCE,2022-09-10,RAD SOLAR,59.29,5
128,BOSQUES SOLARES DE LOS LLANOS 5,2022-09-12,RAD SOLAR,77.19,6
129,BOSQUES SOLARES DE LOS LLANOS 4,2022-09-12,RAD SOLAR,97.09,7
124,LOS CABALLEROS,2022-09-15,RAD SOLAR,106.99,8
125,LA MEDINA,2022-09-15,RAD SOLAR,116.89,9
123,CERRITOS,2022-09-19,RAD SOLAR,126.78999999999999,10
126,AUTOG CELSIA SOLAR HARINAS,2022-09-21,RAD SOLAR,129.24,11
146,AGPE FERCH2,2022-11-17,RAD SOLAR,129.24675,12
112,MONTELIBANO,2022-12-21,RAD SOLAR,139.14675,13
117,TERMOTASAJERO DOS SOLAR,2022-12-26,RAD SOLAR,143.14675,14
114,GRANJA SOLAR LANCEROS,2023-01-30,RAD SOLAR,152.24675,15
115,GRANJA SOLAR SAN FELIPE,2023-01-30,RAD SOLAR,161.34675,16
94,COMUNIDAD EL SALVADOR II,2023-03-24,RAD SOLAR,161.35045,17
95,COMUNIDAD EL SALVADOR I,2023-03-24,RAD SOLAR,161.36315,18
107,CELSIA SOLAR YUMA,2023-03-27,RAD SOLAR,170.46314999999998,19
108,CELSIA SOLAR DULIMA,2023-03-27,RAD SOLAR,190.36315,20
109,GRANJA SOLAR FLANDES,2023-03-27,RAD SOLAR,210.26315,21
113,AUTOG CELSIA SOLAR PALMIRA 3,2023-03-30,RAD SOLAR,215.25315,22
119,TIERRA LINDA,2023-04-04,RAD SOLAR,225.15314999999998,23
120,LA TOLUA,2023-04-04,RAD SOLAR,245.05315,24
110,AUTOG BUGA I GRASAS,2023-04-15,RAD SOLAR,249.05315,25
102,AUTOG CELSIA SOLAR PALMIRA 3 ZONA FRANCA,2023-04-30,RAD SOLAR,251.95315,26
93,AGPE EL ENCANTO,2023-06-08,RAD SOLAR,252.93914999999998,27
111,AUTOG BUGA I SOLLA,2023-06-16,RAD SOLAR,257.83915,28
116,GRANJA SOLAR EL SALADO,2023-06-17,RAD SOLAR,257.93895,29
145,URUACO,2023-06-18,RAD SOLAR,258.93495,30
88,BSB 502,2023-07-31,RAD SOLAR,278.83495,31
89,BSB 501,2023-07-31,RAD SOLAR,298.73494999999997,32
90,BSB 500,2023-07-31,RAD SOLAR,318.63495,33
99,LOS GIRASOLES,2023-08-05,RAD SOLAR,328.13495,34
101,PETALO DEL MAGDALENA,2023-08-05,RAD SOLAR,338.03495,35
135,AUTOG PINTUCO,2023-08-25,RAD SOLAR,339.44095,36
136,AUTOG CI JEANS,2023-08-25,RAD SOLAR,340.83295,37
98,CELSIA SOLAR LA VICTORIA II,2023-08-30,RAD SOLAR,360.73295,38
100,CELSIA SOLAR LA VICTORIA I,2023-08-30,RAD SOLAR,380.63295,39
79,CAIMAN CIENAGUERO,2023-12-15,RAD SOLAR,389.63295,40
80,PETALO DE CORDOBA II,2023-12-16,RAD SOLAR,399.53294999999997,41
78,PARQUE SOLAR HONDA I,2023-12-28,RAD SOLAR,409.43295,42
144,PARQUE SOLAR ARENAL,2023-12-30,RAD SOLAR,411.43295,43
73,LA NENERA,2024-01-13,RAD SOLAR,412.40794999999997,44
57,GD LOS CHORROS,2024-02-16,RAD SOLAR,413.00795,45
63,GD BASILICA,2024-02-16,RAD SOLAR,413.98295,46
82,PARQUE SOLAR LA MENA,2024-02-16,RAD SOLAR,422.98295,47
67,BARAYA,2024-02-18,RAD SOLAR,423.97895,48
58,GD EL BANCO,2024-02-22,RAD SOLAR,424.95394999999996,49
62,GD ALFEREZ,2024-02-22,RAD SOLAR,425.55395,50
64,GANDALF,2024-02-22,RAD SOLAR,426.54994999999997,51
65,CANAHUATE,2024-02-22,RAD SOLAR,427.54595,52
69,MINIGRANJA SAN PEDRO,2024-02-27,RAD SOLAR,428.54185,53
92,PORTON DEL SOL,2024-03-08,RAD SOLAR,530.54185,54
83,PARQUE SOLAR VERSALLES,2024-03-11,RAD SOLAR,539.54185,55
84,PARQUE SOLAR DINAMARCA,2024-03-11,RAD SOLAR,548.54185,56
60,GD LA URIBE,2024-03-14,RAD SOLAR,549.14185,57
61,GD LA HONDA,2024-03-14,RAD SOLAR,550.11685,58
142,EL PASO,2024-03-23,RAD SOLAR,618.11685,59
53,CELSIA SOLAR ALUMINA,2024-03-24,RAD SOLAR,620.08785,60
105,SOLAR PLANETA RICA,2024-04-17,RAD SOLAR,639.98785,61
68,SOLAR ALEJANDRIA,2024-04-27,RAD SOLAR,649.38785,62
56,GD CHICORAL,2024-05-19,RAD SOLAR,650.36285,63
49,AUTOG BIOS CONTEGRAL CARTAGO,2024-05-24,RAD SOLAR,653.58785,64
50,AUTOG BIOS CONTEGRAL NEIVA,2024-05-24,RAD SOLAR,655.18785,65
71,SOL Y CIELO I,2024-05-26,RAD SOLAR,665.08785,66
74,AUTOG EL COPEY,2024-05-31,RAD SOLAR,671.68785,67
81,PARQUE SOLAR TEPUY,2024-06-12,RAD SOLAR,754.68785,68
104,PARQUE SOLAR LA UNION,2024-06-19,RAD SOLAR,854.68785,69
96,FUNDACION,2024-06-24,RAD SOLAR,954.68785,70
140,LATAM SOLAR LA LOMA,2024-06-24,RAD SOLAR,1104.68785,71
103,LA MATA,2024-06-27,RAD SOLAR,1184.68785,72
143,AGPE SUB LIBERTADOR,2024-07-18,RAD SOLAR,1184.70785,73
46,MINIGRANJA LA PAZ VALLENATA,2024-08-13,RAD SOLAR,1185.70385,74
41,GD NAOS I,2024-08-27,RAD SOLAR,1186.66385,75
59,GD CHIMBI,2024-08-28,RAD SOLAR,1187.63885,76
77,PARQUE SOLAR HONDA II,2024-08-31,RAD SOLAR,1197.53885,77
36,GD FINCA JM,2024-09-16,RAD SOLAR,1198.52885,78
54,LA INGLESA,2024-09-16,RAD SOLAR,1199.52485,79
40,GD ERCO TOLDADO,2024-09-19,RAD SOLAR,1200.51485,80
75,GUAMO,2024-09-20,RAD SOLAR,1209.51485,81
76,NUMBANA,2024-09-20,RAD SOLAR,1219.41485,82
72,CELSIA SOLAR BUGALAGRANDE,2024-09-21,RAD SOLAR,1229.31485,83
87,BSB 503,2024-09-26,RAD SOLAR,1249.21485,84
86,BSB 504,2024-09-27,RAD SOLAR,1269.11485,85
42,AUTOG MILPA SAN CARLOS,2024-09-29,RAD SOLAR,1270.91485,86
43,AUTOG UNIMINAS,2024-09-29,RAD SOLAR,1272.71485,87
47,MINIGRANJA EL MOLINO,2024-09-30,RAD SOLAR,1273.71085,88
70,JEQUES,2024-10-04,RAD SOLAR,1283.61085,89
30,AUTOG SOLAR PALMIRA II BERRY,2024-10-09,RAD SOLAR,1288.60085,90
52,SOLAR OLD T,2024-10-16,RAD SOLAR,1298.50085,91
39,AUTOG BIOS FINCA BUGA,2024-10-21,RAD SOLAR,1299.56085,92
48,AUTOG BIOS CIENAGA ORO,2024-11-04,RAD SOLAR,1300.66085,93
35,GD FINCA ISABEL LOPEZ,2024-11-10,RAD SOLAR,1301.65085,94
37,GD ERCO SALDANA II,2024-11-18,RAD SOLAR,1302.64085,95
38,GD ERCO SALDANA I,2024-11-18,RAD SOLAR,1303.63085,96
29,GD EL ROBLE,2024-11-25,RAD SOLAR,1304.62685,97
106,SUNNORTE,2024-11-26,RAD SOLAR,1339.62685,98
118,GUAYEPO,2024-11-30,RAD SOLAR,1709.62685,99
31,MINIGRANJA LA PAZ LEYENDA,2024-12-02,RAD SOLAR,1710.6168499999999,100
45,CELSIA SOLAR PUERTO TEJADA,2024-12-03,RAD SOLAR,1730.51685,101
55,GD PALERMO,2024-12-03,RAD SOLAR,1731.4918499999999,102
34,CENTRO SOLAR,2024-12-11,RAD SOLAR,1741.39185,103
66,CONDOR,2024-12-20,RAD SOLAR,1751.29185,104
85,CARACOLI I,2024-12-22,RAD SOLAR,1801.29185,105
27,GD BOCAS DEL PALO,2024-12-28,RAD SOLAR,1801.39185,106
20,MINIGRANJA VILLANUEVA,2024-12-31,RAD SOLAR,1802.38185,107
44,JUMI,2025-01-17,RAD SOLAR,1812.28185,108
32,MINIGRANJA LA PAZ VERSO,2025-01-18,RAD SOLAR,1813.27185,109
18,GD DIOCESIS DE RIOHACHA,2025-01-25,RAD SOLAR,1813.42185,110
22,AUTOG HIDROSOLAR I,2025-02-04,RAD SOLAR,1815.42185,111
51,ROVIRA,2025-02-14,RAD SOLAR,1818.52185,112
33,MINIGRANJA LA PAZ ESMERALDA,2025-02-26,RAD SOLAR,1819.51185,113
10,MINIGRANJA LA RESERVA,2025-02-28,RAD SOLAR,1820.5018499999999,114
11,GD NAOS II,2025-03-02,RAD SOLAR,1821.46185,115
16,SOL Y CIELO II,2025-03-07,RAD SOLAR,1822.45185,116
17,SOL Y CIELO III,2025-03-07,RAD SOLAR,1823.44185,117
15,SOL Y CIELO IV,2025-03-21,RAD SOLAR,1824.43185,118
28,AUTOG CELSIA SOLAR TQ JAMUNDI,2025-03-26,RAD SOLAR,1826.35185,119
23,GD ERCO GUAMO IV,2025-03-30,RAD SOLAR,1827.34185,120
24,GD ERCO GUAMO III,2025-03-30,RAD SOLAR,1828.33185,121
25,GD ERCO GUAMO II,2025-03-30,RAD SOLAR,1829.32185,122
4,AUTOG MOLINOS SANTA MARTA,2025-03-31,RAD SOLAR,1832.62185,123
5,AUTOG COMOLSA,2025-03-31,RAD SOLAR,1835.92185,124
6,AUTOG QBCO,2025-03-31,RAD SOLAR,1839.22185,125
9,SOLAR PALMASECA I,2025-03-31,RAD SOLAR,1852.22185,126
3,ROKRA,2025-04-05,RAD SOLAR,1862.12185,127
13,MINIGRANJA LA PUYA,2025-04-07,RAD SOLAR,1863.11185,128
19,MINIGRANJA EL MERENGUE,2025-04-16,RAD SOLAR,1864.10185,129
26,GD ERCO GUAMO I,2025-04-26,RAD SOLAR,1865.09185,130
14,MINIGRANJA EL SON,2025-04-28,RAD SOLAR,1866.08185,131
21,PARQUE SOLAR BARANOA,2025-04-30,RAD SOLAR,1885.98185,132
7,GD NAOS III,2025-05-02,RAD SOLAR,1886.94185,133
8,SOL Y CIELO VI,2025-05-08,RAD SOLAR,1887.93185,134
12,SOL Y CIELO V,2025-05-08,RAD SOLAR,1888.92185,135
2,GD SAN MARTIN,2025-05-11,RAD SOLAR,1889.91185,136
1,GD SAN MARTIN II,2025-05-25,RAD SOLAR,1890.90185,137
132,PARQUE EOLICO GUAJIRA I,2022-04-30,VIENTO,19.9,1
121,PARQUE EOLICO WESP01,2022-08-31,VIENTO,31.9,2
`;
        drawChart(csv);

        function drawChart(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');

            const rows = lines.slice(1).map(line => {
                const parts = line.split(',');
                return {
                    nombre_proyecto: parts[1],
                    fecha_finalizacion: parts[2],
                    numero_proyectos: parseFloat(parts[5]),
                    tipo_proyecto_fuente: parts[3],
                };
            });

            const tipos_tecnologia = [...new Set(rows.map(r => r.tipo_proyecto_fuente))];

            const dataPorTipo = {};
            const nombresPorTipoFecha = {};

            tipos_tecnologia.forEach(tipo => {
                dataPorTipo[tipo] = {};
                nombresPorTipoFecha[tipo] = {};
            });

            rows.forEach(row => {
                const { tipo_proyecto_fuente, fecha_finalizacion, numero_proyectos, nombre_proyecto } = row;
                dataPorTipo[tipo_proyecto_fuente][fecha_finalizacion] = numero_proyectos;
                nombresPorTipoFecha[tipo_proyecto_fuente][fecha_finalizacion] = nombre_proyecto;
            });

            const hoy = new Date().toISOString().split('T')[0];

            const fechas_ordenadas = [...new Set([...rows.map(r => r.fecha_finalizacion), hoy])]
                .sort((a, b) => new Date(a) - new Date(b));

            const series = tipos_tecnologia.map(tipo => {
                let acumulado = 0;
                const data = fechas_ordenadas.map(fecha => {
                    if (dataPorTipo[tipo][fecha] !== undefined) {
                        acumulado = dataPorTipo[tipo][fecha];
                    }
                    return {
                        y: acumulado,
                        name: nombresPorTipoFecha[tipo][fecha] || 'Sin proyecto'
                    };
                });
                return {
                    name: tipo,
                    data: data
                };
            });

            Highcharts.chart('container', {
                chart: {
                    type: 'area'
                },
                title: {
                    text: 'Número de proyectos por tipo'
                },
                xAxis: {
                    categories: fechas_ordenadas,
                    title: { text: 'Fecha de finalización' },
                },
                yAxis: {
                    title: {
                        text: 'Número de proyectos'
                    }
                },
                tooltip: {
                    shared: true,
                    formatter: function () {
                        let s = `<b>Fecha: ${this.x}</b>`;
                        this.points.forEach(point => {
                            s += `<br/><span style="color:${point.color}">\u25CF</span> ${point.series.name}: <b>${point.y}</b>`;
                            s += `<br/>&nbsp;&nbsp;&nbsp;&nbsp;<i>${point.point.name}</i>`;
                        });
                        return s;
                    }
                },
                legend: {
                    layout: 'horizontal',
                    align: 'center',
                    verticalAlign: 'top'
                },
                plotOptions: {
                    area: {
                        stacking: 'normal',
                        marker: {
                            enabled: false
                        }
                    }
                },
                series: series
            });
        }
    </script>
</body>
</html>